<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Para Ti üíñ</title>
  <meta name="description" content="Un detallito web hecho con amor." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0f0f14;
      --card:#151521;
      --ink:#ffffff;
      --muted:#cbd5e1;
      --brand:#ff4d8d;
      --brand-2:#ffafcc;
      --accent:#7dd3fc;
      --glow:0 0 40px rgba(255,77,141,.35),0 0 8px rgba(255,77,141,.65);
      --radius:22px;
    }
    *{box-sizing:border-box}
    html,body{margin:0;height:100%;}
    body{font:16px/1.55 "Poppins",system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:radial-gradient(1200px 800px at 85% -10%,rgba(125,211,252,.18),transparent 60%),
      radial-gradient(800px 500px at -10% 10%,rgba(255,175,204,.14),transparent 60%),
      var(--bg);color:var(--ink)}
    .wrap{max-width:1100px;margin:0 auto;padding:20px 18px 80px}
    header{position:sticky;top:0;background:linear-gradient(180deg,rgba(15,15,20,.9),rgba(15,15,20,.55) 60%,transparent);backdrop-filter:saturate(130%) blur(8px);z-index:50}
    .nav{display:flex;gap:10px;align-items:center;justify-content:space-between;padding:14px 0}
    .brand{display:flex;align-items:center;gap:10px}
    .heart{width:34px;height:34px;border-radius:50%;background:radial-gradient(circle at 30% 30%,#fff, #ffd1e1 30%, #ff7aa5 60%, #ff4d8d 80%);box-shadow:var(--glow)}
    .title{font-weight:800;letter-spacing:.5px}
    .tabs{display:flex;gap:8px;flex-wrap:wrap}
    .tab{padding:8px 12px;border-radius:999px;background:rgba(255,255,255,.06);color:#fff;border:1px solid rgba(255,255,255,.08);cursor:pointer}
    .tab[aria-current="true"]{background:var(--brand);border-color:#ff8fb4;color:#12121b;box-shadow:var(--glow)}

    .hero{display:grid;grid-template-columns:1.2fr .8fr;gap:20px;align-items:center;margin:22px 0}
    .card{background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.02));border:1px solid rgba(255,255,255,.08);border-radius:var(--radius);padding:20px;box-shadow:0 4px 30px rgba(0,0,0,.25)}
    .hero h1{font-size:clamp(28px,5vw,48px);margin:6px 0 8px}
    .hero p{color:var(--muted);margin:0}
    .pill{display:inline-flex;align-items:center;gap:8px;padding:6px 12px;border-radius:999px;background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.1)}
    .cta{display:flex;gap:10px;margin-top:16px}
    .btn{padding:12px 16px;border-radius:14px;border:1px solid rgba(255,255,255,.1);background:#1b1b27;color:#fff;cursor:pointer}
    .btn.primary{background:linear-gradient(135deg,var(--brand),#ff7aa5);border-color:#ff9ec3;color:#12121b;box-shadow:var(--glow)}

    /* floating hearts */
    .floaters{position:relative;min-height:260px;overflow:hidden;border-radius:var(--radius)}
    .floater{position:absolute;bottom:-40px;font-size:18px;animation:rise var(--d) linear infinite;opacity:.85;filter:drop-shadow(0 6px 10px rgba(255,77,141,.25))}
    @keyframes rise{from{transform:translateY(40px)}to{transform:translateY(-320px) rotate(20deg)}}

    section{scroll-margin-top:90px;margin-top:28px}
    h2{margin:0 0 10px}
    .muted{color:var(--muted)}

    /* carta tipeada */
    .type{min-height:120px;white-space:pre-wrap}
    .cursor{display:inline-block;width:10px;background:#ff8fb4;margin-left:2px;animation:blink 1s steps(2,end) infinite}
    @keyframes blink{50%{background:transparent}}

    /* motivos */
    .grid{display:grid;gap:14px}
    .grid.m3{grid-template-columns:repeat(3,1fr)}
    .grid.m2{grid-template-columns:repeat(2,1fr)}
    @media (max-width:900px){.hero{grid-template-columns:1fr}.grid.m3{grid-template-columns:1fr 1fr}}
    @media (max-width:620px){.grid.m2,.grid.m3{grid-template-columns:1fr}}
    .reason{padding:16px;border-radius:18px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.08)}

    /* timeline */
    .timeline{position:relative;padding-left:18px}
    .timeline::before{content:"";position:absolute;left:6px;top:0;bottom:0;width:2px;background:linear-gradient(var(--brand),transparent)}
    .step{position:relative;margin:16px 0;padding-left:8px}
    .dot{position:absolute;left:-2px;top:4px;width:12px;height:12px;border-radius:50%;background:var(--brand);box-shadow:0 0 0 4px rgba(255,77,141,.15)}

    /* galer√≠a */
    .gallery{display:grid;grid-template-columns:repeat(3,1fr);gap:10px}
    @media (max-width:800px){.gallery{grid-template-columns:repeat(2,1fr)}}
    @media (max-width:520px){.gallery{grid-template-columns:1fr}}
    .ph{position:relative;border-radius:16px;overflow:hidden;aspect-ratio:4/3;background:linear-gradient(135deg,#1e1e2b,#232336);border:1px solid rgba(255,255,255,.08);display:grid;place-items:center;color:#a5b4fc}
    .ph img{width:100%;height:100%;object-fit:cover;display:block}
    .ph button{position:absolute;bottom:8px;right:8px}

    dialog{border:none;border-radius:18px;max-width:min(92vw,900px);background:#0f0f14}
    dialog::backdrop{background:rgba(0,0,0,.6)}
    .full img{max-width:92vw;max-height:80vh;border-radius:14px}

    /* quiz */
    .q{margin:10px 0;padding:14px;border-radius:14px;background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.08)}
    .q label{display:block;margin:6px 0;cursor:pointer}
    .q input{margin-right:8px}

    /* countdown */
    .count{display:flex;gap:10px;flex-wrap:wrap}
    .chip{min-width:110px;text-align:center;padding:12px;border-radius:14px;background:#1b1b27;border:1px solid rgba(255,255,255,.08)}
    .chip strong{display:block;font-size:24px}

    /* sorpresa + confetti */
    .hidden{display:none !important}
    .confetti{position:fixed;inset:0;pointer-events:none;overflow:hidden}
    .piece{position:absolute;width:10px;height:16px;opacity:.9;animation:fall linear forwards}
    @keyframes fall{to{transform:translateY(110vh) rotate(720deg);opacity:1}}

    /* footer */
    footer{margin-top:32px;color:#9aa2b2;text-align:center}
    footer a{color:#cbd5e1}
  </style>
</head>
<body>
  <header>
    <div class="wrap nav">
      <div class="brand"><div class="heart" aria-hidden="true"></div><div class="title">Para <span id="nombre-dest">Ti</span> üíñ</div></div>
      <nav class="tabs" aria-label="Secciones">
        <button class="tab" data-go="#carta" aria-current="true">Carta</button>
        <button class="tab" data-go="#motivos">Motivos</button>
        <button class="tab" data-go="#momentos">Momentos</button>
        <button class="tab" data-go="#galeria">Galer√≠a</button>
        <button class="tab" data-go="#juego">Juego</button>
        <button class="tab" data-go="#cuenta">Pr√≥xima cita</button>
      </nav>
    </div>
  </header>

  <div class="wrap">
    <div class="hero">
      <div class="card">
        <span class="pill">Hecho con amor por <strong id="nombre-rem">m√≠</strong> ‚ú®</span>
        <h1 id="hero-title">Eres mi persona favorita</h1>
        <p id="hero-sub" class="muted">Abr√≠ esta p√°gina para decirte, de mil formas, lo mucho que te amo.</p>
        <div class="cta">
          <button class="btn primary" id="btn-scroll">L√©ela ahora</button>
          <button class="btn" id="btn-compartir">Copiar link con tu nombre</button>
        </div>
      </div>
      <div class="card floaters" aria-hidden="true" id="floaters"></div>
    </div>

    <!-- CARTA -->
    <section id="carta" class="card">
      <h2>üíå Carta</h2>
      <p class="muted">(Tip: baja el volumen de tu celular y dale play si quieres m√∫sica de fondo)</p>
      <audio id="musica" controls preload="none" style="width:100%"></audio>
      <div class="type" id="type"></div><span class="cursor" id="cursor"></span>
      <div style="margin-top:12px;display:flex;gap:10px;flex-wrap:wrap">
        <button class="btn" id="btn-replay">Repetir carta</button>
        <button class="btn" onclick="window.print()">Imprimir/Guardar PDF</button>
      </div>
    </section>

    <!-- MOTIVOS -->
    <section id="motivos" class="card">
      <h2>üåü 9 cosas que amo de ti</h2>
      <div class="grid m3" id="reasons"></div>
    </section>

    <!-- MOMENTOS (TIMELINE) -->
    <section id="momentos" class="card">
      <h2>üóìÔ∏è Nuestros momentos</h2>
      <div class="timeline" id="timeline"></div>
    </section>

    <!-- GALER√çA -->
    <section id="galeria" class="card">
      <h2>üì∑ Galer√≠a</h2>
      <p class="muted">Reemplaza las im√°genes por las tuyas editando el archivo (busca <code>imagenes</code> en el c√≥digo). Toca para ver en grande.</p>
      <div class="gallery" id="gal"></div>
      <dialog id="lightbox"><div class="full"><img alt="" id="fullimg"></div></dialog>
    </section>

    <!-- JUEGO/QUIZ -->
    <section id="juego" class="card">
      <h2>üéÆ Mini juego: ¬øcu√°nto me conoces?</h2>
      <div id="quiz"></div>
      <button class="btn primary" id="btn-quiz">Enviar respuestas</button>
      <p id="quiz-res" class="muted"></p>
      <div id="sorpresa" class="hidden">
        <hr style="border:0;border-top:1px solid rgba(255,255,255,.08);margin:16px 0">
        <h3>üéÅ Sorpresa desbloqueada</h3>
        <p class="muted">Abriste mi coraz√≥n. Presiona el bot√≥n para ver la magia ‚ú®</p>
        <button class="btn primary" id="btn-confetti">¬°Celebrar!</button>
        <div class="card" style="margin-top:12px">
          <h3>üíñ Carta final</h3>
          <p id="carta-final">Gracias por existir. Mi plan favorito siempre ser√° <strong>contigo</strong>. Vamos por todo lo bonito que nos falta vivir. ‚Äî <span id="firma"></span></p>
        </div>
      </div>
    </section>

    <!-- CUENTA REGRESIVA -->
    <section id="cuenta" class="card">
      <h2>‚è≥ Cuenta regresiva para nuestra pr√≥xima cita</h2>
      <div style="display:flex;gap:8px;flex-wrap:wrap;margin-bottom:8px">
        <input id="fecha" type="datetime-local" class="btn" style="padding:10px" />
        <button class="btn" id="btn-start">Iniciar</button>
        <button class="btn" id="btn-clear">Limpiar</button>
      </div>
      <div class="count" id="count"></div>
    </section>

    <footer>
      Hecho con üíñ por <span id="pie-rem">alguien que te ama</span> ¬∑ <a href="#" id="copylink">Copiar link</a>
    </footer>
  </div>

  <div class="confetti" id="confetti" aria-hidden="true"></div>

  <script>
    // ========= util =========
    const qs=(s,p=document)=>p.querySelector(s);
    const qsa=(s,p=document)=>[...p.querySelectorAll(s)];
    const params=new URLSearchParams(location.search);
    const nombre = params.get('para') || localStorage.getItem('para') || 'Ti';
    const de = params.get('de') || localStorage.getItem('de') || 'm√≠';
    const musicaURL = params.get('musica') || '';

    localStorage.setItem('para', nombre);
    localStorage.setItem('de', de);

    // ========= header + hero =========
    qs('#nombre-dest').textContent = nombre;
    qs('#nombre-rem').textContent = de;
    qs('#pie-rem').textContent = de;

    // floaters hearts
    const floaters = qs('#floaters');
    const EMOJIS=['üíñ','üíó','üíì','üíû','üíò','üíù','üíï','‚ù§Ô∏è'];
    for(let i=0;i<26;i++){
      const e=document.createElement('div');
      e.className='floater';
      e.style.left=Math.random()*92+"%";
      e.style.setProperty('--d', (6+Math.random()*8)+'s');
      e.textContent=EMOJIS[Math.floor(Math.random()*EMOJIS.length)];
      floaters.appendChild(e);
    }

    // tabs scroll
    qsa('.tab').forEach(t=>t.addEventListener('click',()=>{
      qsa('.tab').forEach(x=>x.removeAttribute('aria-current'));
      t.setAttribute('aria-current','true');
      const id=t.getAttribute('data-go');
      location.hash=id;
      document.querySelector(id).scrollIntoView({behavior:'smooth'});
    }))
    qs('#btn-scroll').onclick=()=>document.querySelector('#carta').scrollIntoView({behavior:'smooth'});

    // compartir link
    function linkConNombre(){
      const u=new URL(location.href);
      u.searchParams.set('para', nombre);
      u.searchParams.set('de', de);
      return u.toString();
    }
    async function copiar(texto){
      try{ await navigator.clipboard.writeText(texto); alert('¬°Link copiado!'); }catch(err){
        // fallback
        const ta=document.createElement('textarea'); ta.value=texto; document.body.appendChild(ta); ta.select(); document.execCommand('copy'); ta.remove(); alert('Link copiado');
      }
    }
    qs('#btn-compartir').onclick=()=>copiar(linkConNombre());
    qs('#copylink').onclick=(e)=>{e.preventDefault(); copiar(location.href)}

    // ========= m√∫sica =========
    const audio=qs('#musica');
    if(musicaURL){ audio.src=musicaURL; }

    // ========= carta tipeada =========
    const textoCarta = `Hola ${nombre}:

Solo quer√≠a recordarte que eres mi lugar seguro, mi risa favorita y mi coincidencia m√°s bonita. Gracias por acompa√±arme en todo, por tu paciencia, por tus abrazos que arreglan mis d√≠as y por creer en nosotros.

Prometo seguir eligi√©ndote en lo cotidiano: en los mensajitos, en las llamadas de ‚Äúya llegu√©‚Äù, en los planes locos y tambi√©n en los domingos de flojera. Eres mi hogar.

Con amor,
${de}`;

    const box=qs('#type');
    const cursor=qs('#cursor');
    let idx=0, timer=null;
    function escribir(){
      clearInterval(timer); box.textContent=''; idx=0; cursor.style.display='inline-block';
      timer=setInterval(()=>{
        if(idx>=textoCarta.length){ clearInterval(timer); cursor.style.display='none'; return; }
        box.textContent += textoCarta[idx++];
      }, 25);
    }
    escribir();
    qs('#btn-replay').onclick=escribir;

    // ========= motivos =========
    const MOTIVOS=[
      ['Tu risa','Porque incluso a distancia me alegra el d√≠a.'],
      ['Tu mirada','Me da paz y me recuerda por qu√© vale la pena todo.'],
      ['Tus mensajes','Nunca llegan tarde, siempre llegan cuando m√°s los necesito.'],
      ['C√≥mo me escuchas','Siento que soy visto y entendido por ti.'],
      ['Tus abrazos','Ah√≠ cabe el mundo y me siento en casa.'],
      ['Nuestros planes','Desde lo peque√±o hasta lo grande, contigo todo es especial.'],
      ['Tu fuerza','Me inspiras a ser mejor todos los d√≠as.'],
      ['Tu paciencia','Gracias por quedarte incluso cuando el camino se pone dif√≠cil.'],
      ['Nosotros','Porque lo nuestro es equipo, compa√±√≠a y amor.']
    ];
    const reasons=qs('#reasons');
    MOTIVOS.forEach(([t,d])=>{
      const c=document.createElement('div'); c.className='reason';
      c.innerHTML=`<strong>${t}</strong><p class="muted" style="margin:6px 0 0">${d}</p>`;
      reasons.appendChild(c);
    });

    // ========= timeline =========
    const MOMENTOS=[
      ['El inicio','Ese d√≠a que empezamos a hablarnos diferente'],
      ['La primera salida','Las mariposas confirmaron lo que ya sab√≠amos'],
      ['Nuestro futuro','Lo bonito que estamos construyendo juntos']
    ];
    const tl=qs('#timeline');
    MOMENTOS.forEach(([t,d])=>{
      const s=document.createElement('div'); s.className='step';
      s.innerHTML=`<div class="dot"></div><strong>${t}</strong><div class="muted">${d}</div>`;
      tl.appendChild(s);
    });

    // ========= galer√≠a =========
    const imagenes=[
      // Reemplaza por tus fotos o links (pueden ser URLs p√∫blicas o rutas locales)
      'https://images.unsplash.com/photo-1522673607200-164d1b6ce486?q=80&w=1400&auto=format&fit=crop',
      'https://images.unsplash.com/photo-1513635269975-59663e0ac1ad?q=80&w=1400&auto=format&fit=crop',
      'https://images.unsplash.com/photo-1520975922299-6cb1230a1fbc?q=80&w=1400&auto=format&fit=crop',
      'https://images.unsplash.com/photo-1496483648148-47c686dc86a8?q=80&w=1400&auto=format&fit=crop',
      'https://images.unsplash.com/photo-1537633552985-df8429e8048b?q=80&w=1400&auto=format&fit=crop',
      'https://images.unsplash.com/photo-1460364157752-926555421a7e?q=80&w=1400&auto=format&fit=crop'
    ];
    const gal=qs('#gal');
    imagenes.forEach((src,i)=>{
      const ph=document.createElement('div'); ph.className='ph';
      const img=document.createElement('img'); img.loading='lazy'; img.alt='Foto'; img.src=src;
      const b=document.createElement('button'); b.className='btn'; b.textContent='Ver';
      b.onclick=()=>{ qs('#fullimg').src=src; qs('#lightbox').showModal(); };
      ph.append(img,b); gal.appendChild(ph);
    })
    qs('#lightbox').addEventListener('click',e=>{ if(e.target.tagName==='DIALOG') e.target.close(); })

    // ========= quiz =========
    const PREGUNTAS=[
      {t:`¬øMi plan perfecto contigo?`, o:['Cine y palomitas','Caminata y helado','Marat√≥n de series','Viaje sorpresa'], ok:1},
      {t:`¬øMi apodo favorito para ti?`, o:['Amor','Vida','Chiquita/o','Mi persona'], ok:3},
      {t:`¬øCanci√≥n que me recuerda a ti?`, o:['La que te haga sonre√≠r','Cualquiera que bailemos','Nuestra playlist','Todas las anteriores'], ok:3},
    ];
    const qbox=qs('#quiz');
    PREGUNTAS.forEach((q,qi)=>{
      const d=document.createElement('div'); d.className='q';
      d.innerHTML=`<div><strong>${qi+1}. ${q.t}</strong></div>`;
      q.o.forEach((op,oi)=>{
        const id=`q${qi}_${oi}`;
        const lab=document.createElement('label');
        lab.innerHTML=`<input type="radio" name="q${qi}" value="${oi}"> ${op}`;
        d.appendChild(lab);
      })
      qbox.appendChild(d);
    })

    qs('#btn-quiz').onclick=()=>{
      let score=0; let total=PREGUNTAS.length; let faltan=false;
      PREGUNTAS.forEach((q,qi)=>{
        const sel=qs(`input[name=q${qi}]:checked`);
        if(!sel){ faltan=true; return; }
        if(+sel.value===q.ok) score++;
      })
      if(faltan){ qs('#quiz-res').textContent='Responde todas las preguntas üí°'; return; }
      qs('#quiz-res').textContent = `Tu puntaje: ${score}/${total} ${score===total? '¬°Perfecto! üíò':''}`;
      if(score>=2){ qs('#sorpresa').classList.remove('hidden'); }
    }
    qs('#firma').textContent=de;

    // ========= cuenta regresiva =========
    const countBox=qs('#count');
    let timerCount=null;
    function renderCount(t){
      function pad(n){return String(n).padStart(2,'0')} 
      const now=new Date(); const diff=t-now; if(diff<=0){ countBox.innerHTML='<div class="muted">¬°Es hoy! üíñ</div>'; return; }
      const s=Math.floor(diff/1000);
      const d=Math.floor(s/86400), h=Math.floor((s%86400)/3600), m=Math.floor((s%3600)/60), ss=s%60;
      countBox.innerHTML='';
      [['D√≠as',d],['Horas',h],['Min',m],['Seg',ss]].forEach(([k,v])=>{
        const c=document.createElement('div'); c.className='chip';
        c.innerHTML=`<strong>${pad(v)}</strong>${k}`; countBox.appendChild(c);
      })
    }
    function startCount(){
      const val=qs('#fecha').value; if(!val){ alert('Elige fecha y hora'); return; }
      const t=new Date(val);
      localStorage.setItem('proxima', t.toISOString());
      clearInterval(timerCount);
      renderCount(t);
      timerCount=setInterval(()=>renderCount(t),1000);
    }
    qs('#btn-start').onclick=startCount;
    qs('#btn-clear').onclick=()=>{ localStorage.removeItem('proxima'); clearInterval(timerCount); countBox.innerHTML=''; qs('#fecha').value=''; };
    const saved=localStorage.getItem('proxima'); if(saved){ const t=new Date(saved); qs('#fecha').value=t.toISOString().slice(0,16); startCount(); }

    // ========= confetti =========
    function confetti(){
      const wrap=qs('#confetti');
      const colors=['#ff4d8d','#ffafcc','#7dd3fc','#a7f3d0','#fde68a'];
      for(let i=0;i<160;i++){
        const p=document.createElement('div'); p.className='piece';
        const x=Math.random()*100; const d=6+Math.random()*5; const s=.6+Math.random()*1.2; const color=colors[i%colors.length];
        p.style.left=x+'vw'; p.style.top='-5vh'; p.style.background=color; p.style.transform=`translateY(0) rotate(${Math.random()*360}deg)`; p.style.animationDuration=d+'s';
        p.style.width=(6+Math.random()*8)+'px'; p.style.height=(8+Math.random()*16)+'px'; p.style.animationTimingFunction='cubic-bezier(.12,.4,.29,.99)';
        wrap.appendChild(p);
        setTimeout(()=>p.remove(), d*1000);
      }
    }
    qs('#btn-confetti').onclick=confetti;
    window.addEventListener('keydown',e=>{ if(e.key==='‚ô•' || e.key==='c') confetti(); });

    // ========= accesibilidad / focus =========
    qsa('button, input').forEach(el=>{ el.addEventListener('focus',()=>el.style.outline='2px solid var(--accent)'); el.addEventListener('blur',()=>el.style.outline='none'); });
  </script>
</body>
</html>
